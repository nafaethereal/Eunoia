<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Eunoia</title>
    <link rel="stylesheet" href="style.css">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@700,500,400&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="dashboard-page hidden">
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <img src="logo.png" alt="Eunoia Logo" class="logo-img-small">
            </div>
            <ul class="nav-links">
                <li class="nav-item active" data-tab="gallery">
                    <span class="icon"><i class="fa-regular fa-image"></i></span> Gallery
                </li>
                <li class="nav-item" data-tab="journal">
                    <span class="icon"><i class="fa-solid fa-feather-pointed"></i></span> Journal
                </li>
                <li class="nav-item" data-tab="overview">
                    <span class="icon"><i class="fa-solid fa-chart-simple"></i></span> Overview
                </li>
            </ul>
            <div class="sidebar-footer">
                <div class="user-profile">
                    <img id="user-avatar" src="" alt="User" class="avatar">
                    <span id="user-name" class="username">User</span>
                </div>
                <button id="logout-btn" class="btn-logout"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Gallery Section -->
            <section id="gallery-section" class="content-section active">
                <header class="section-header">
                    <div class="header-main">
                        <h2>Gallery</h2>
                        <span id="gallery-last-upload" class="last-upload-info"></span>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button id="manage-categories-btn" class="btn-soft">Manage Categories</button>
                        <button id="open-upload-modal" class="btn-primary">+ Upload Art</button>
                    </div>
                </header>

                <div class="filter-bar">
                    <!-- Dynamic buttons from JS -->
                </div>

                <div id="gallery-grid" class="gallery-grid">
                    <!-- Gallery items will be injected here -->
                    <div class="loading-state">Loading gallery...</div>
                </div>
            </section>

            <!-- Journal Section -->
            <section id="journal-section" class="content-section">
                <header class="section-header">
                    <h2>My Journal</h2>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span class="date-display" id="today-date"></span>
                    </div>
                </header>

                <div class="journal-editor">
                    <textarea id="journal-entry"
                        placeholder="How are you feeling today? Write your thoughts..."></textarea>

                    <div class="journal-controls">
                        <div class="mood-selector">
                            <label>Mood:</label>
                            <select id="mood-select">
                                <option value="amazing">Amazing ü§©</option>
                                <option value="happy">Happy üòä</option>
                                <option value="good">Good üòÑ</option>
                                <option value="content">Content üòå</option>
                                <option value="neutral" selected>Neutral üòê</option>
                                <option value="tired">Tired üò¥</option>
                                <option value="sad">Sad üò¢</option>
                                <option value="anxious">Anxious üò∞</option>
                                <option value="angry">Angry üò†</option>
                                <option value="terrible">Terrible üò≠</option>
                            </select>
                        </div>
                        <div class="rating-selector">
                            <label>Rating:</label>
                            <div class="rating-input-wrapper" style="display: flex; align-items: center; gap: 5px;">
                                <input type="number" id="rating-input" min="0" max="10" step="0.1" value="5"
                                    placeholder="0-10" style="width: 70px; padding: 5px; text-align: center;">
                                <span class="rating-max">/10</span>
                            </div>
                        </div>
                        <div class="photo-upload-section">
                            <label for="journal-photo">Add Photo (Optional):</label>
                            <input type="file" id="journal-photo" accept="image/*">
                            <div id="journal-photo-preview" class="hidden">
                                <div class="preview-item">
                                    <img id="journal-preview-img" src="#" alt="Preview">
                                    <button type="button" id="remove-journal-photo" class="btn-remove-overlay"
                                        title="Remove Photo">&times;</button>
                                </div>
                            </div>
                        </div>
                        <button id="save-journal-btn" class="btn-primary" style="margin-top: 20px;">Save Entry</button>
                    </div>
                </div>

                <div id="journal-history" class="journal-list">
                    <div class="list-header">
                        <h3>Past Entries</h3>
                        <div class="list-actions">
                            <button id="toggle-select-mode" class="btn-soft"
                                style="padding: 6px 12px; font-size: 0.8rem; border-radius: 9px;"><i
                                    class="fas fa-check-square"></i> Select</button>
                            <div class="bulk-actions hidden" id="journal-bulk-actions">
                                <span id="selected-count">0 items selected</span>
                                <button id="bulk-delete-btn" class="btn-delete-small"><i class="fas fa-trash-alt"></i>
                                    Delete Selected</button>
                                <button id="cancel-selection-btn" class="btn-link">Cancel</button>
                            </div>
                        </div>
                    </div>
                    <div id="journal-entries-container">
                        <!-- Journal entries injected here -->
                    </div>
                </div>
            </section>

            <!-- Overview Section -->
            <section id="overview-section" class="content-section">
                <header class="section-header">
                    <h2>Monthly Overview</h2>
                    <div class="overview-controls">
                        <select id="overview-month-year" class="btn-soft-small"
                            style="font-size: 0.85rem; padding: 5px 10px;">
                            <!-- Options will be populated by JS -->
                        </select>
                    </div>
                </header>

                <div class="stats-container overview-stats">
                    <div class="stat-card">
                        <h3>Presence</h3>
                        <p id="stat-presence">-</p>
                        <span id="stat-presence-diff" class="stat-subtext">-</span>
                    </div>
                    <div class="stat-card">
                        <h3>Writing rhythm</h3>
                        <p id="stat-rhythm" class="stat-text-md">-</p>
                    </div>
                    <div class="stat-card reflection-card">
                        <h3>Reflection</h3>
                        <p id="stat-reflection" class="stat-text-sm">-</p>
                    </div>
                </div>

                <div class="secondary-stats">
                    <div class="sec-stat"><span>Avg Mood:</span> <strong id="stat-mood-monthly">-</strong></div>
                    <div class="sec-stat"><span>Avg Rate:</span> <strong id="stat-rating-monthly">-</strong></div>
                </div>

                <div class="overview-chart-container"
                    style="background: white; padding: 20px; border-radius: var(--radius-md); box-shadow: var(--shadow-sm); margin-top: 20px;">
                    <canvas id="overview-chart"></canvas>
                </div>
            </section>

        </main>
    </div>

    <!-- Upload Modal -->
    <div id="upload-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3 class="modal-title">Share your art</h3>
            <form id="upload-form">
                <div class="form-group">
                    <label for="art-file">Choose Image</label>
                    <input type="file" id="art-file" accept="image/*" required>
                </div>
                <div class="preview-container">
                    <img id="image-preview" src="#" alt="Preview" class="hidden">
                </div>
                <div class="form-group">
                    <label for="art-category">Category</label>
                    <select id="art-category">
                        <option value="Digital">Digital Art</option>
                        <option value="Traditional">Traditional Art</option>
                        <option value="3D">3D Render</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="art-caption">Caption (Optional)</label>
                    <textarea id="art-caption" rows="2" placeholder="Tell us about this piece..."></textarea>
                </div>
                <button type="submit" class="btn-primary" id="upload-submit-btn">Upload</button>
            </form>
        </div>
    </div>

    <!-- Edit Gallery Modal -->
    <div id="edit-gallery-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal close-edit-gallery-modal">&times;</span>
            <h3 class="modal-title">Edit Artwork</h3>
            <form id="edit-gallery-form">
                <div class="form-group">
                    <label>Current Image</label>
                    <div class="preview-container">
                        <img id="edit-gallery-photo-preview" src="" alt="Preview" class="hidden">
                    </div>
                    <div class="photo-actions">
                        <button type="button" id="change-gallery-photo" class="btn-link">Change Photo</button>
                        <button type="button" id="remove-gallery-photo" class="btn-link text-delete">Remove
                            Photo</button>
                    </div>
                    <input type="file" id="edit-gallery-photo-input" accept="image/*" class="hidden">
                </div>
                <div class="form-group">
                    <label for="edit-art-category">Category</label>
                    <select id="edit-art-category">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-art-caption">Caption</label>
                    <textarea id="edit-art-caption" rows="2"></textarea>
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Edit Journal Modal -->
    <div id="edit-journal-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal close-edit-modal">&times;</span>
            <h3 class="modal-title">Edit Entry</h3>
            <form id="edit-journal-form">
                <div class="form-group">
                    <label for="edit-journal-entry">Your Thoughts</label>
                    <textarea id="edit-journal-entry" rows="4"></textarea>
                </div>
                <div class="journal-controls">
                    <div class="mood-selector">
                        <label>Mood:</label>
                        <select id="edit-mood-select">
                            <option value="amazing">Amazing ü§©</option>
                            <option value="happy">Happy üòä</option>
                            <option value="good">Good üòÑ</option>
                            <option value="content">Content üòå</option>
                            <option value="neutral">Neutral üòê</option>
                            <option value="tired">Tired üò¥</option>
                            <option value="sad">Sad üò¢</option>
                            <option value="anxious">Anxious üò∞</option>
                            <option value="angry">Angry üò†</option>
                            <option value="terrible">Terrible üò≠</option>
                        </select>
                    </div>
                    <div class="rating-selector">
                        <label>Rating (0-10):</label>
                        <input type="number" id="edit-rating-input" min="0" max="10" step="0.1"
                            style="width: 60px; padding: 5px;">
                    </div>
                </div>

                <div class="photo-upload-section">
                    <label>Photo</label>
                    <div id="edit-photo-preview-container" class="preview-container">
                        <img id="edit-photo-preview" src="" alt="Entry Photo" class="hidden" style="max-height: 200px;">
                    </div>
                    <div class="photo-actions">
                        <button type="button" id="change-edit-photo" class="btn-link">Change Photo</button>
                        <button type="button" id="remove-edit-photo" class="btn-link text-delete">Remove Photo</button>
                    </div>
                    <input type="file" id="edit-photo-input" accept="image/*" class="hidden">
                </div>

                <div style="margin-top: 20px; text-align: left;">
                    <button type="submit" class="btn-primary">Update Entry</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Lightbox -->
    <div id="photo-lightbox" class="lightbox hidden">
        <div class="lightbox-container">
            <span class="lightbox-close">&times;</span>

            <button id="lightbox-prev" class="lightbox-nav lightbox-prev">
                <i class="fas fa-chevron-left"></i>
            </button>

            <div class="lightbox-image-wrapper">
                <img id="lightbox-img" src="" alt="Full View">
            </div>

            <button id="lightbox-next" class="lightbox-nav lightbox-next">
                <i class="fas fa-chevron-right"></i>
            </button>

            <div class="lightbox-bottom-ui">
                <div id="lightbox-counter" class="lightbox-counter"></div>
                <div class="lightbox-actions hidden">
                    <button id="lightbox-edit-photo" class="btn-primary-small">Edit Entry</button>
                    <button id="lightbox-delete-photo" class="btn-delete-small">Delete Entry</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="category-modal" class="modal hidden">
        <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
            <span class="close-modal close-category-modal">&times;</span>
            <h3 class="modal-title">Manage Categories</h3>
            <div class="add-category-form" style="display: flex; gap: 10px; margin-bottom: 20px;">
                <input type="text" id="new-category-name" placeholder="New Category Name"
                    style="flex: 1; padding: 10px; border: 1px solid var(--border-color); border-radius: var(--radius-sm);">
                <button id="add-category-btn" class="btn-primary">Add</button>
            </div>
            <div id="category-list" class="category-list" style="display: grid; gap: 10px;">
                <!-- Categories injected here -->
            </div>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 400px; text-align: center; padding: 30px;">
            <h3 class="modal-title" style="margin-bottom: 10px;">Log Out?</h3>
            <p style="color: var(--text-muted); margin-bottom: 25px;">Are you sure you want to end your session?</p>
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="cancel-logout" class="btn-soft" style="flex: 1;">Cancel</button>
                <button id="confirm-logout" class="btn-primary" style="background-color: #dc3545; flex: 1;">Log
                    Out</button>
            </div>
        </div>
    </div>

    <!-- Custom Dialog (Alert/Confirm) -->
    <div id="custom-dialog" class="modal hidden" style="z-index: 5000;">
        <div class="modal-content" style="max-width: 400px; text-align: center; padding: 30px;">
            <h3 id="dialog-title" class="modal-title">Alert</h3>
            <p id="dialog-message" style="color: var(--text-main); margin: 20px 0;">Message goes here.</p>
            <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                <button id="dialog-cancel" class="btn-soft hidden">Cancel</button>
                <button id="dialog-confirm" class="btn-primary" style="min-width: 100px;">OK</button>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p style="margin-top: 15px; color: var(--primary-wood); font-weight: 500;">Processing...</p>
    </div>

    <script type="module" src="app.js"></script>
</body>

</html>